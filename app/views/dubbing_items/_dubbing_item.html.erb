<div id="<%= dom_id dubbing_item %>" 
     class="dubbing-item" 
     data-controller="dubbing-item"
     data-dubbing-item-project-id-value="<%= dubbing_item.project.id %>"
     data-dubbing-item-item-id-value="<%= dubbing_item.id %>"
     data-dubbing-item-focus-on-connect-value="<%= local_assigns[:autofocus] || false %>">

  <!-- Thumbnail Area -->
  <div class="thumbnail-area" 
       data-dubbing-item-target="thumbnail"
       data-action="dragover->dubbing-item#dragOver dragleave->dubbing-item#dragLeave drop->dubbing-item#drop">
    
    <% if dubbing_item.image.attached? %>
      <%= image_tag dubbing_item.image, class: "thumbnail-image" %>
    <% else %>
      <div class="thumbnail-placeholder">
        <span>Drop Image</span>
      </div>
    <% end %>

    <%= form_with url: upload_image_project_dubbing_item_path(dubbing_item.project, dubbing_item), method: :post, class: "hidden" do |f| %>
      <%= f.file_field :image, data: { dubbing_item_target: "fileInput" }, accept: "image/*" %>
    <% end %>
  </div>

  <!-- Text Input Area -->
  <div class="text-area-wrapper" style="flex: 1; display: flex; flex-direction: column;">
    <%= form_with model: [dubbing_item.project, dubbing_item], data: { dubbing_item_target: "form" } do |f| %>
      <%= f.text_area :content, 
          class: "dubbing-textarea", 
          placeholder: "Type your dubbing text here...",
          rows: 1,
          data: { 
            dubbing_item_target: "textarea",
            action: "input->dubbing-item#handleInput change->dubbing-item#save keydown->dubbing-item#handleKeydown"
          } %>
    <% end %>
  </div>

  <!-- Controls -->
  <div class="item-controls">
    <button type="button" class="delete-btn" data-action="click->dubbing-item#deleteItem" title="Delete Item">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
    </button>
  </div>
</div>
